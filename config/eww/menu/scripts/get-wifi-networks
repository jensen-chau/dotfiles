#!/bin/bash
# Get available WiFi networks in JSON format

echo "["
first=true

nmcli -t -f SSID,SIGNAL,ACTIVE dev wifi | while IFS=: read -r ssid signal active; do
    if [ -n "$ssid" ]; then
        if [ "$first" = true ]; then
            first=false
        else
            echo ","
        fi
        echo "{"
        echo "  \"ssid\": \"$ssid\","
        echo "  \"signal\": $signal,"
        echo "  \"connected\": $([ "$active" = "yes" ] && echo "true" || echo "false")"
        echo -n "}"
    fi
done

echo "]"